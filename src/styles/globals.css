@import "tailwindcss";

/* Theme variables are provided by `src/styles/index.css`.
   Avoid redefining the core --background / --foreground variables here
   so the user's theme file can control the palette. globals.css still
   contains utility mappings and overrides that reference those variables. */

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);

  --font-sans: var(--font-sans);
  --font-mono: var(--font-mono);
  --font-serif: var(--font-serif);

  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);

  --shadow-2xs: var(--shadow-2xs);
  --shadow-xs: var(--shadow-xs);
  --shadow-sm: var(--shadow-sm);
  --shadow: var(--shadow);
  --shadow-md: var(--shadow-md);
  --shadow-lg: var(--shadow-lg);
  --shadow-xl: var(--shadow-xl);
  --shadow-2xl: var(--shadow-2xl);

  --tracking-tighter: calc(var(--tracking-normal) - 0.05em);
  --tracking-tight: calc(var(--tracking-normal) - 0.025em);
  --tracking-normal: var(--tracking-normal);
  --tracking-wide: calc(var(--tracking-normal) + 0.025em);
  --tracking-wider: calc(var(--tracking-normal) + 0.05em);
  --tracking-widest: calc(var(--tracking-normal) + 0.1em);
}

body {
  letter-spacing: var(--tracking-normal);
  margin: 0;
  padding: 0;
    font-family: 'Arial', sans-serif; /* Changed font for better compatibility */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background-color: var(--color-background);
  color: var(--color-foreground);
}

/* Nuclear fallback: paint a dark layer behind everything so even rogue
   light backgrounds sit on black. The fixed pseudo-element ignores layout
   and sits at the viewport base. */
body::before {
  content: "";
  position: fixed;
  inset: 0;
  background: #000000;
  z-index: -1;
  pointer-events: none;
}

/* Hard enforcement for dark mode: if .dark is present on html or body,
   lock the palette and surface colors with !important so late-loading light
   styles cannot override them. */
html.dark,
body.dark {
  --background: #000000 !important;
  --foreground: #ffffff !important;
  --card: #000000 !important;
  --card-foreground: #ffffff !important;
  --popover: #1a1a1a !important; /* Darker panel background */
  --popover-foreground: #ffffff !important;
  --primary: #2dd4bf !important; /* Bright turquoise */
  --primary-foreground: #000000 !important;
  --secondary: #ff8c00 !important; /* Saffron orange */
  --secondary-foreground: #000000 !important;
  --muted: #2a2a2a !important; /* Darker muted background */
  --muted-foreground: #d4d4d4 !important; /* Lighter muted text */
  --accent: #8b4513 !important; /* Rich brown */
  --accent-foreground: #ffffff !important;
  --destructive: #dc2626 !important; /* Red for destructive actions */
  --destructive-foreground: #ffffff !important;
  --border: #654321 !important; /* Brown borders */
  --input: #1a1a1a !important; /* Dark input background */
  --ring: #2dd4bf !important; /* Turquoise focus ring */
  --chart-1: #2dd4bf !important; /* Turquoise */
  --chart-2: #2dd4bf !important; /* Turquoise */
  --chart-3: #ff8c00 !important; /* Saffron */
  --chart-4: #ff8c00 !important; /* Saffron */
  --chart-5: #8b4513 !important; /* Brown */
  --sidebar: #1a1a1a !important;
  --sidebar-foreground: #ffffff !important;
  --sidebar-primary: #2dd4bf !important;
  --sidebar-primary-foreground: #000000 !important;
  --sidebar-accent: #ff8c00 !important;
  --sidebar-accent-foreground: #000000 !important;
  --sidebar-border: #654321 !important;
  --sidebar-ring: #2dd4bf !important;
  background-color: #000000 !important;
  color: #ffffff !important;
}

/* High-specificity theme enforcement: ensure the CSS variables drive the app
   backgrounds and foregrounds even if Tailwind or other styles try to set
   explicit whites. This uses !important intentionally to guarantee theme
   consistency across Electron/iframe contexts. */
html,
body,
#root,
.h-screen,
.bg-app {
  background-color: var(--color-background) !important;
  color: var(--color-foreground) !important;
}

/* Semantic outline / border colors (light + dark map to --color-border) */
:root,
.dark {
  --outline-1: color-mix(in srgb, var(--color-border) 12%, transparent);
  --outline-2: color-mix(in srgb, var(--color-border) 24%, transparent);
  --outline-3: color-mix(in srgb, var(--color-border) 40%, transparent);
}

/* Grey-outline helpers to give subtle separation without harsh white/black lines */
.outline-1 {
  box-shadow: 0 0 0 1px var(--outline-1) inset;
}
.outline-2 {
  box-shadow: 0 0 0 1px var(--outline-2) inset;
}
.outline-3 {
  box-shadow: 0 0 0 1px var(--outline-3) inset;
}

/* Map common Tailwind border utilities to semantic outline color */
.border,
.border-2,
.border-t,
.border-r,
.border-b,
.border-l,
.border-gray-500,
.border-gray-600,
.border-gray-700,
.border-gray-800 {
  border-color: var(--color-border) !important;
}

/* Subtle focus/ ring overrides that should use the ring color but fall back to outline shades */
.ring,
.ring-2,
.ring-4 {
  --tw-ring-color: var(--color-ring) !important;
}
.ring-default {
  box-shadow:
    0 0 0 1px var(--outline-2),
    0 0 0 4px color-mix(in srgb, var(--color-ring) 12%, transparent);
}

/* Ensure background uses semantic color variable */
.bg-app {
  background-color: var(--color-background) !important;
}
/* Compact control helpers */
.control,
button,
input,
select,
textarea {
  font-size: var(--control-font-size);
}

.control--compact,
button.compact,
input.compact,
select.compact,
textarea.compact {
  padding: var(--control-padding-compact);
  font-size: var(--control-font-size-compact);
  border-radius: var(--compact-radius);
}

.control--dense {
  display: inline-flex;
  gap: var(--control-gap);
  align-items: center;
}

.strip-controls {
  display: flex;
  gap: 0.375rem;
  align-items: center;
}

.card,
.panel {
  padding: 0.35rem;
  border-radius: var(--compact-radius);
  box-shadow: var(--compact-shadow);
}

/* Utility: reduce global gaps for denser layouts */
.dense {
  --spacing: var(--spacing-compact);
}

/* Inputs & selects default compact appearance */
input,
select,
textarea {
  padding: var(--control-padding);
  border: 1px solid var(--color-border);
  border-radius: var(--radius);
}

/* When applying the compact class globally, controls shrink */
body.compact input,
body.compact select,
body.compact textarea,
body.compact button {
  padding: var(--control-padding-compact);
  font-size: var(--control-font-size-compact);
  border-radius: var(--compact-radius);
}

/* Broad fallback: ensure visible subtle outlines on major interactive elements */
button,
.btn,
input,
select,
textarea,
.card,
.panel,
.control,
.chip,
.badge {
  border: 2px solid #654321 !important; /* Brown border */
  box-shadow:
    0 0 0 1px color-mix(in srgb, var(--color-border) 12%, transparent) inset,
    0 2px 4px rgba(0, 0, 0, 0.3) !important; /* Black shadow */
}

/* If color-mix isn't supported, ensure a plain border fallback */
@supports not (
  color: color-mix(in srgb, var(--color-border) 12%, transparent)
) {
  button,
  .btn,
  input,
  select,
  textarea,
  .card,
  .panel,
  .control,
  .chip,
  .badge {
    border-color: var(--color-border) !important;
  }
}

/* Small helpers for editor visuals */
.panel-muted {
  background: var(--color-muted);
  color: var(--color-muted-foreground);
}

.muted-text {
  color: var(--color-muted-foreground);
}

/* Compact control helpers */
.control,
button,
input,
select,
textarea {
  font-size: var(--control-font-size);
}

.control--compact,
button.compact,
input.compact,
select.compact,
textarea.compact {
  padding: var(--control-padding-compact);
  font-size: var(--control-font-size-compact);
  border-radius: var(--compact-radius);
}

.control--dense {
  display: inline-flex;
  gap: var(--control-gap);
  align-items: center;
}

.strip-controls {
  display: flex;
  gap: 0.375rem;
  align-items: center;
}

.card,
.panel {
  padding: 0.35rem;
  border-radius: var(--compact-radius);
  box-shadow: var(--compact-shadow);
}

/* Utility: reduce global gaps for denser layouts */
.dense {
  --spacing: var(--spacing-compact);
}

/* Inputs & selects default compact appearance */
input,
select,
textarea {
  padding: var(--control-padding);
  border: 1px solid var(--color-border);
  border-radius: var(--radius);
}

/* When applying the compact class globally, controls shrink */
body.compact input,
body.compact select,
body.compact textarea,
body.compact button {
  padding: var(--control-padding-compact);
  font-size: var(--control-font-size-compact);
  border-radius: var(--compact-radius);
}

#root {
  width: 100%;
  height: 100vh;
  overflow: hidden;
}

/* Custom scrollbar styles */
.scrollbar-thin::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

.scrollbar-thin::-webkit-scrollbar-track {
  background-color: #d2b48c; /* Tan background */
  border: 1px solid #654321; /* Brown border */
  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.4); /* Black shadow */
}

.scrollbar-thin::-webkit-scrollbar-thumb {
  background-color: #c0c0c0; /* Silver slider handle */
  border-radius: 4px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.5); /* Black shadow */
}

.scrollbar-thin::-webkit-scrollbar-thumb:hover {
  background-color: #a8a8a8; /* Darker silver on hover */
}

/* Firefox scrollbar styling */
.scrollbar-thin {
  scrollbar-width: thin;
  scrollbar-color: #c0c0c0 #d2b48c; /* Silver thumb, tan track */
}

/* Force utility classes to follow our theme variables in all modes
   (override Tailwind's generated color tokens when necessary). */
.bg-gray-950,
.bg-gray-900 {
  background-color: var(--background) !important;
}
.bg-gray-800 {
  background-color: var(--sidebar) !important;
}
.bg-gray-700,
.bg-gray-700\/50 {
  background-color: var(--popover) !important;
}
.text-gray-900,
.text-gray-950 {
  color: var(--foreground) !important;
}

/* Additional text color overrides for dark mode */
.dark .text-gray-100,
.dark .text-gray-200,
.dark .text-gray-300,
.dark .text-gray-400,
.dark .text-gray-500,
.dark .text-gray-600,
.dark .text-gray-700,
.dark .text-gray-800 {
  color: var(--muted-foreground) !important;
}

/* Ensure buttons and interactive elements have proper contrast */
.dark button,
.dark .btn,
.dark input,
.dark select,
.dark textarea {
  color: var(--foreground) !important;
  background-color: var(--popover) !important;
}

/* Accent mappings */
.bg-blue-600,
.bg-blue-500 {
  background-color: var(--primary) !important;
}
.bg-green-600,
.bg-green-500 {
  background-color: var(--chart-2) !important;
}
.bg-red-600,
.bg-red-500 {
  background-color: var(--accent) !important;
}
.bg-yellow-600,
.bg-yellow-500 {
  background-color: var(--chart-3) !important;
}
.bg-purple-600,
.bg-purple-500 {
  background-color: var(--chart-4) !important;
}

/* Borders and rings */
.border-gray-800 {
  border-color: var(--sidebar) !important;
}
.border-gray-700 {
  border-color: var(--popover) !important;
}
.ring-blue-800,
.ring-blue-400\/50 {
  --tw-ring-color: var(--primary) !important;
}

/* Semantic borders/outlines for cards, controls and buttons */
.card,
.panel {
  border: 2px solid #654321; /* Brown border */
  box-shadow:
    0 0 0 1px var(--outline-1) inset,
    0 4px 8px rgba(0, 0, 0, 0.4); /* Black shadow */
  background-color: var(--card);
  color: var(--card-foreground);
}

button,
.btn,
.control,
input,
select,
textarea {
  border: 2px solid #654321 !important; /* Brown border */
  color: var(--color-foreground);
  background-color: transparent;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3) !important; /* Black shadow */
}

/* Prefer semantic popover/card backgrounds over raw gray utilities */
.bg-gray-600,
.bg-gray-500 {
  background-color: var(--popover) !important;
  color: var(--popover-foreground) !important;
}

/* When components use gray-700/800 ensure they map to popover/sidebar */
.bg-gray-700,
.bg-gray-800 {
  background-color: var(--popover) !important;
  color: var(--popover-foreground) !important;
}

/* Broad selector: any element that uses a Tailwind background utility should
   get a subtle outline so it won't visually blend into the page background. */
[class*="bg-"] {
  border: 2px solid #654321 !important; /* Brown border */
  box-shadow:
    0 0 0 1px color-mix(in srgb, var(--color-border) 12%, transparent) inset,
    0 2px 4px rgba(0, 0, 0, 0.3) !important; /* Black shadow */
}

/* Semantic component color helpers (map to theme tokens) */
.status-on {
  background-color: #2dd4bf !important; /* Turquoise */
  border: 2px solid #654321 !important; /* Brown border */
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4) !important; /* Black shadow */
}
.status-off {
  background-color: #8b4513 !important; /* Brown */
  border: 2px solid #654321 !important; /* Brown border */
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4) !important; /* Black shadow */
}
.status-on-text {
  color: #2dd4bf !important; /* Turquoise text */
}

.btn-primary {
  background-color: #2dd4bf !important; /* Turquoise */
  color: #000000 !important;
  border: 2px solid #654321 !important; /* Brown border */
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4) !important; /* Black shadow */
}
.btn-primary:hover {
  background-color: #25b5a8 !important; /* Slightly darker turquoise */
  box-shadow:
    0 0 8px rgba(45, 212, 191, 0.4),
    0 4px 8px rgba(0, 0, 0, 0.5) !important; /* Turquoise glow + enhanced black shadow */
}

.btn-yellow {
  background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%) !important;
  color: #000000 !important;
  border: 2px solid #fcd34d !important;
  box-shadow: 0 0 8px rgba(251, 191, 36, 0.3), 0 2px 4px rgba(0, 0, 0, 0.3) !important;
}
.btn-yellow:hover:not(:disabled) {
  background: linear-gradient(135deg, #fcd34d 0%, #fbbf24 100%) !important;
  box-shadow: 0 0 12px rgba(251, 191, 36, 0.5), 0 2px 4px rgba(0, 0, 0, 0.3) !important;
}

.btn-disabled {
  background-color: #2a2a2a !important; /* Dark muted background */
  color: #666666 !important; /* Muted text */
  border: 2px solid #654321 !important; /* Brown border */
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3) !important; /* Subtle black shadow */
  cursor: not-allowed;
}

.btn-small {
  background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); /* Yellow gradient */
  color: #000000; /* Black text */
  border: 2px solid #fcd34d; /* Yellow border */
  border-radius: 6px;
  padding: 0.25rem 0.5rem;
  box-shadow: 0 0 8px rgba(251, 191, 36, 0.3), 0 2px 4px rgba(0, 0, 0, 0.3); /* Yellow glow */
}
.btn-small:hover {
  background: linear-gradient(135deg, #fcd34d 0%, #fbbf24 100%); /* Lighter yellow on hover */
  box-shadow: 0 0 12px rgba(251, 191, 36, 0.5), 0 2px 4px rgba(0, 0, 0, 0.3);
}
.btn-danger {
  background-color: #8b4513; /* Brown */
  color: #ffffff;
  border: 2px solid #654321; /* Brown border */
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4); /* Black shadow */
}

.input {
  background-color: #1a1a1a; /* Dark panel background */
  color: #d4d4d4; /* Light muted text */
  border: 2px solid #654321; /* Brown border */
  padding: 0.25rem 0.5rem;
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3); /* Black shadow */
}
.input.small {
  padding: 0.125rem 0.375rem;
  font-size: 0.8rem;
}
.input:focus {
  outline: none;
  border-color: #2dd4bf; /* Turquoise border on focus */
  box-shadow:
    0 0 0 3px rgba(45, 212, 191, 0.2),
    0 4px 8px rgba(0, 0, 0, 0.4); /* Turquoise glow + enhanced black shadow */
}

.index-badge {
  background: #1a1a1a; /* Dark panel background */
  color: #d4d4d4; /* Light muted text */
  border: 2px solid #654321; /* Brown border */
  width: 1.75rem;
  height: 1.75rem;
  border-radius: 9999px;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4); /* Black shadow */
}

.pattern-badge {
  background: #1a1a1a; /* Dark panel background */
  color: #d4d4d4; /* Light muted text */
  border: 2px solid #654321; /* Brown border */
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4); /* Black shadow */
}

/* Dark mode override for pattern-badge (Ready button) */
.dark .pattern-badge {
  background: #1a1a1a !important; /* Dark panel background */
  color: #d4d4d4 !important; /* Light muted text */
  border: 2px solid #654321 !important; /* Brown border */
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4) !important; /* Black shadow */
}

.chord-label {
  letter-spacing: -0.01em;
}

/* Chord semantic colors */
.chord-bg-default {
  background-color: #1a1a1a; /* Dark panel background */
  border: 2px solid #654321; /* Brown border */
  filter: drop-shadow(
    0 8px 12px rgba(101, 67, 33, 0.3)
  ); /* Brown glow from bottom */
}
.chord-text-default {
  color: #d4d4d4; /* Light muted text */
}
.chord-ring-default {
  --tw-ring-color: #654321; /* Brown ring */
}

.chord-bg-maj {
  background-color: #ff8c00; /* Saffron */
  border: 2px solid #654321; /* Brown border */
  filter: drop-shadow(
    0 8px 12px rgba(255, 140, 0, 0.5)
  ); /* Saffron glow from bottom */
}
.chord-text-maj {
  color: #000000; /* Black text on saffron */
}
.chord-ring-maj {
  --tw-ring-color: #ff8c00; /* Saffron ring */
}

.chord-bg-min {
  background-color: #2dd4bf; /* Turquoise */
  border: 2px solid #654321; /* Brown border */
  filter: drop-shadow(
    0 8px 12px rgba(45, 212, 191, 0.5)
  ); /* Turquoise glow from bottom */
}
.chord-text-min {
  color: #000000; /* Black text on turquoise */
}
.chord-ring-min {
  --tw-ring-color: #2dd4bf; /* Turquoise ring */
}

.chord-bg-dim {
  background-color: #d8b4fe; /* Lavender */
  border: 2px solid #654321; /* Brown border */
  filter: drop-shadow(
    0 8px 12px rgba(216, 180, 254, 0.5)
  ); /* Lavender glow from bottom */
}
.chord-text-dim {
  color: #000000; /* Black text on lavender */
}
.chord-ring-dim {
  --tw-ring-color: #d8b4fe; /* Lavender ring */
}

.chord-bg-aug {
  background-color: #ef4444; /* Red */
  border: 2px solid #654321; /* Brown border */
  filter: drop-shadow(
    0 8px 12px rgba(239, 68, 68, 0.5)
  ); /* Red glow from bottom */
}
.chord-text-aug {
  color: #ffffff; /* White text on red */
}
.chord-ring-aug {
  --tw-ring-color: #ef4444; /* Red ring */
}

.chord-bg-dom {
  background-color: #ef4444; /* Red */
  border: 2px solid #654321; /* Brown border */
  filter: drop-shadow(
    0 8px 12px rgba(239, 68, 68, 0.5)
  ); /* Red glow from bottom */
}
.chord-text-dom {
  color: #ffffff !important; /* White text on red */
}
.chord-ring-dom {
  --tw-ring-color: #ef4444; /* Red ring */
}

.slot-border {
  border-color: #654321; /* Brown border */
}
.slot-selected {
  border: 2px solid #2dd4bf !important; /* Turquoise border when selected */
  outline: 1px solid #2dd4bf !important;
  outline-offset: 1px;
}
.slot-in-pattern {
  box-shadow:
    0 0 0 2px rgba(255, 140, 0, 0.3),
    0 2px 6px rgba(0, 0, 0, 0.4); /* Saffron glow + black shadow */
}

/* White glow for duration pads that are lit */
.duration-lit {
  outline: 1px solid #ffffff !important;
  outline-offset: 2px;
  box-shadow: 0 0 8px rgba(255, 255, 255, 0.4) !important;
}

/* Note / quality buttons */
.note-selected {
  background-color: #2dd4bf; /* Turquoise */
  color: #000000; /* Black text */
  border: 2px solid #654321; /* Brown border */
  box-shadow:
    0 0 0 3px rgba(45, 212, 191, 0.4),
    0 2px 6px rgba(0, 0, 0, 0.4); /* Turquoise glow + black shadow */
}
.note-black {
  background-color: #8b4513; /* Brown */
  color: #ffffff; /* White text */
  border: 2px solid #654321; /* Brown border */
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4); /* Black shadow */
}
.note-default {
  background-color: #1a1a1a; /* Dark panel background */
  color: #d4d4d4; /* Light muted text */
  border: 2px solid #654321; /* Brown border */
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3); /* Black shadow */
}

/* Major - Orange (theme color) */
.quality-maj {
  background: linear-gradient(135deg, #ff8c00 0%, #ff7700 100%) !important;
  color: #000000 !important;
  border: 2px solid #ff9500 !important;
  box-shadow: 0 0 12px rgba(255, 140, 0, 0.4), 0 2px 4px rgba(0, 0, 0, 0.3) !important;
}
.quality-maj span {
  color: #000000 !important;
}

/* Minor - Turquoise (theme color) */
.quality-min {
  background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%) !important;
  color: #000000 !important;
  border: 2px solid #2dd4bf !important;
  box-shadow: 0 0 12px rgba(20, 184, 166, 0.4), 0 2px 4px rgba(0, 0, 0, 0.3) !important;
}
.quality-min span {
  color: #000000 !important;
}

/* Dominant - Yellow (theme color) */
.quality-dom {
  background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%) !important;
  color: #000000 !important;
  border: 2px solid #fcd34d !important;
  box-shadow: 0 0 12px rgba(251, 191, 36, 0.4), 0 2px 4px rgba(0, 0, 0, 0.3) !important;
}
.quality-dom span {
  color: #000000 !important;
}

/* Diminished - Purple (outlier) */
.quality-dim {
  background: linear-gradient(135deg, #a855f7 0%, #9333ea 100%) !important;
  color: #ffffff !important;
  border: 2px solid #c084fc !important;
  box-shadow: 0 0 12px rgba(168, 85, 247, 0.4), 0 2px 4px rgba(0, 0, 0, 0.3) !important;
}
.quality-dim span {
  color: #ffffff !important;
}

/* Augmented - Pink (outlier) */
.quality-aug {
  background: linear-gradient(135deg, #ec4899 0%, #db2777 100%) !important;
  color: #ffffff !important;
  border: 2px solid #f472b6 !important;
  box-shadow: 0 0 12px rgba(236, 72, 153, 0.4), 0 2px 4px rgba(0, 0, 0, 0.3) !important;
}
.quality-aug span {
  color: #ffffff !important;
}

/* Suspended - Red (outlier) */
.quality-sus {
  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%) !important;
  color: #ffffff !important;
  border: 2px solid #f87171 !important;
  box-shadow: 0 0 12px rgba(239, 68, 68, 0.4), 0 2px 4px rgba(0, 0, 0, 0.3) !important;
}
.quality-sus span {
  color: #ffffff !important;
}

/* Extended/Add - Green (outlier) */
.quality-ext {
  background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important;
  color: #ffffff !important;
  border: 2px solid #34d399 !important;
  box-shadow: 0 0 12px rgba(16, 185, 129, 0.4), 0 2px 4px rgba(0, 0, 0, 0.3) !important;
}
.quality-ext span {
  color: #ffffff !important;
}

/* Altered - Blue (outlier) */
.quality-alt {
  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%) !important;
  color: #ffffff !important;
  border: 2px solid #60a5fa !important;
  box-shadow: 0 0 12px rgba(59, 130, 246, 0.4), 0 2px 4px rgba(0, 0, 0, 0.3) !important;
}
.quality-alt span {
  color: #ffffff !important;
}

/* Power/Special - Peach */
.quality-power {
  background: linear-gradient(135deg, #fb923c 0%, #f97316 100%) !important;
  color: #000000 !important;
  border: 2px solid #fdba74 !important;
  box-shadow: 0 0 12px rgba(251, 146, 60, 0.4), 0 2px 4px rgba(0, 0, 0, 0.3) !important;
}
.quality-power span {
  color: #000000 !important;
}
.quality-selected {
  border: 2px solid #2dd4bf !important; /* Turquoise border when selected */
  box-shadow: 0 0 0 1px rgba(45, 212, 191, 0.8) !important; /* Thin glowing border */
}

.quality-default {
  background-color: #1a1a1a; /* Dark panel background */
  color: #d4d4d4; /* Light muted text */
  border: 2px solid #654321; /* Brown border */
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3); /* Black shadow */
}

.panel {
  background-color: #1a1a1a; /* Dark panel background */
  color: #d4d4d4; /* Light muted text */
  border: 2px solid #654321; /* Brown border */
  box-shadow:
    0 0 8px rgba(139, 69, 19, 0.2),
    0 4px 12px rgba(0, 0, 0, 0.5); /* Brown glow + enhanced black shadow */
}
.panel-title {
  color: #d4d4d4; /* Light muted text */
}

/* Top header: glass shell + non-interactive timeline preview synced to footer playhead */
.app-top-header {
  position: relative;
  height: 64px;
  overflow: hidden;
  border-bottom: 1px solid rgba(0, 0, 0, 0.68);
  background: rgba(8, 8, 8, 0.16);
  backdrop-filter: blur(10px) saturate(130%);
  -webkit-backdrop-filter: blur(10px) saturate(130%);
  box-shadow:
    inset 0 14px 18px rgba(0, 0, 0, 0.34),
    inset 0 -8px 12px rgba(0, 0, 0, 0.2),
    inset 0 1px 0 rgba(255, 255, 255, 0.03);
}

.app-top-header-timeline {
  position: absolute;
  inset: 0;
  z-index: 0;
  overflow: hidden;
  pointer-events: none;
  --cyl-strength: 1.42;
  --cyl-contrast: 1.18;
  --header-sweep-pos: 48%;
  --header-sweep-opacity: 0.2;
  --header-sweep-width: 14%;
  background-image:
    linear-gradient(
      90deg,
      transparent calc(var(--header-sweep-pos) - var(--header-sweep-width)),
      rgb(255 244 218 / var(--header-sweep-opacity)) var(--header-sweep-pos),
      transparent calc(var(--header-sweep-pos) + var(--header-sweep-width))
    ),
    url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200"%3E%3Cfilter id="noise"%3E%3CfeTurbulence baseFrequency="0.9" numOctaves="4"/%3E%3C/filter%3E%3Crect width="200" height="200" filter="url(%23noise)" opacity="0.03"/%3E%3C/svg%3E'),
    linear-gradient(
      90deg,
      rgb(0 0 0 / calc(0.74 * var(--cyl-strength))) 0%,
      rgb(0 0 0 / calc(0.56 * var(--cyl-strength))) 6%,
      rgb(0 0 0 / calc(0.31 * var(--cyl-strength))) 14%,
      rgb(0 0 0 / calc(0.12 * var(--cyl-strength))) 25%,
      rgb(0 0 0 / calc(0.03 * var(--cyl-strength))) 40%,
      rgb(0 0 0 / calc(0.03 * var(--cyl-strength))) 60%,
      rgb(0 0 0 / calc(0.12 * var(--cyl-strength))) 75%,
      rgb(0 0 0 / calc(0.31 * var(--cyl-strength))) 86%,
      rgb(0 0 0 / calc(0.56 * var(--cyl-strength))) 94%,
      rgb(0 0 0 / calc(0.74 * var(--cyl-strength))) 100%
    ),
    linear-gradient(
      180deg,
      rgb(24 16 8 / calc(0.22 * var(--cyl-contrast))) 0%,
      rgb(255 232 188 / calc(0.05 * var(--cyl-contrast))) 44%,
      rgb(0 0 0 / calc(0.2 * var(--cyl-contrast))) 100%
    );
  background-color: hsl(40, 22%, 68%);
  border-top: 1px solid rgba(0, 0, 0, 0.38);
  border-bottom: 1px solid rgba(0, 0, 0, 0.58);
  box-shadow:
    inset 0 1px 0 rgb(0 0 0 / calc(0.46 * var(--cyl-contrast))),
    inset 0 -1px 0 rgb(0 0 0 / calc(0.62 * var(--cyl-contrast))),
    inset 0 3px 4px rgb(0 0 0 / calc(0.20 * var(--cyl-contrast))),
    inset 0 -3px 4px rgb(0 0 0 / calc(0.28 * var(--cyl-contrast))),
    inset 0 0 0 1px rgb(0 0 0 / calc(0.1 * var(--cyl-contrast)));
}

.app-top-header-timeline::before,
.app-top-header-timeline::after {
  content: "";
  position: absolute;
  left: 0;
  right: 0;
  pointer-events: none;
  z-index: 1;
}

/* Subtle rim occlusion only: cylinder motion is horizontal, so curvature
   is mainly conveyed by left/right shading in the base gradients. */
.app-top-header-timeline::before {
  top: 0;
  height: 7px;
  background:
    linear-gradient(
      to bottom,
      rgb(0 0 0 / calc(0.66 * var(--cyl-contrast))) 0%,
      rgb(0 0 0 / calc(0.36 * var(--cyl-contrast))) 34%,
      rgb(0 0 0 / calc(0.14 * var(--cyl-contrast))) 68%,
      transparent 100%
    );
}

.app-top-header-timeline::after {
  bottom: 0;
  height: 7px;
  background:
    linear-gradient(
      to top,
      rgb(0 0 0 / calc(0.78 * var(--cyl-contrast))) 0%,
      rgb(0 0 0 / calc(0.44 * var(--cyl-contrast))) 34%,
      rgb(0 0 0 / calc(0.16 * var(--cyl-contrast))) 70%,
      transparent 100%
    );
}

.app-top-header-scroll-strip {
  display: flex;
  align-items: center;
  gap: 8px;
  height: 100%;
  min-width: max-content;
  padding: 0 50vw;
  will-change: transform;
}

.header-preview-card {
  height: 46px;
  flex-shrink: 0;
  padding: 6px 10px;
  overflow: hidden;
  border: 1px solid rgba(0, 0, 0, 0.20);
  border-radius: 6px;
  background: rgba(0, 0, 0, 0.08);
  box-shadow:
    inset 0 2px 2px rgba(0, 0, 0, 0.2),
    inset 0 -7px 10px rgba(0, 0, 0, 0.12),
    0 0 0 1px rgba(0, 0, 0, 0.04);
  transform: translateY(0);
  filter: saturate(0.92) contrast(0.97);
}

.header-preview-title {
  margin: 0 0 2px;
  font-size: 10px;
  font-weight: 700;
  color: rgba(0, 0, 0, 0.9);
  letter-spacing: 0.2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.header-preview-line {
  margin: 0;
  font-size: 8px;
  color: rgba(0, 0, 0, 0.75);
  line-height: 1.2;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.app-top-header::after {
  content: "";
  position: absolute;
  inset: 0;
  z-index: 1;
  pointer-events: none;
  background:
    linear-gradient(
      180deg,
      rgba(255, 255, 255, 0.24) 0%,
      rgba(255, 255, 255, 0.11) 9%,
      rgba(255, 255, 255, 0.04) 17%,
      rgba(0, 0, 0, 0.07) 42%,
      rgba(0, 0, 0, 0.12) 66%,
      rgba(255, 255, 255, 0.02) 100%
    );
}

.app-top-header-menu-layer {
  position: relative;
  z-index: 2;
  height: 100%;
  width: 100%;
  padding: 0 1.25rem;
  display: flex;
  align-items: center;
  pointer-events: auto;
}

.header-brand {
  position: relative;
  z-index: 2;
  display: inline-flex;
  align-items: center;
  font-size: 0.78rem;
  font-weight: 800;
  letter-spacing: 0.1em;
  padding: 0.22rem 0.52rem;
  border-radius: 999px;
  color: #f6e6be !important;
  text-transform: uppercase;
  background:
    linear-gradient(
      180deg,
      rgba(255, 255, 255, 0.17) 0%,
      rgba(255, 255, 255, 0.09) 14%,
      rgba(0, 0, 0, 0.18) 54%,
      rgba(0, 0, 0, 0.38) 100%
    );
  border: 1px solid rgba(255, 221, 161, 0.34);
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.25),
    inset 0 -2px 0 rgba(0, 0, 0, 0.46),
    inset 0 -7px 12px rgba(0, 0, 0, 0.24),
    inset 0 7px 10px rgba(255, 255, 255, 0.07),
    0 1px 0 rgba(255, 255, 255, 0.1),
    0 4px 12px rgba(0, 0, 0, 0.52);
  text-shadow:
    0 1px 0 rgba(0, 0, 0, 0.82),
    0 0 8px rgba(255, 206, 120, 0.28),
    0 0 16px rgba(255, 177, 71, 0.2);
}

.header-brand::before {
  content: "";
  display: inline-block;
  width: 0.36rem;
  height: 0.36rem;
  margin-right: 0.34rem;
  border-radius: 999px;
  background: radial-gradient(circle at 35% 35%, #ffe4a8 0%, #f59e0b 72%, #8b5e09 100%);
  box-shadow:
    0 0 6px rgba(255, 200, 97, 0.55),
    0 0 12px rgba(245, 158, 11, 0.35);
}

.header-brand::after {
  content: "";
  position: absolute;
  inset: -3px -2px -6px -2px;
  border-radius: 999px;
  z-index: -1;
  background: radial-gradient(
    84% 84% at 50% 36%,
    rgba(255, 212, 132, 0.2) 0%,
    rgba(0, 0, 0, 0.08) 66%,
    rgba(0, 0, 0, 0) 100%
  );
  filter: blur(6px);
}

.header-mode-arc {
  display: inline-flex;
  align-items: flex-end;
  gap: 0.12rem;
  margin-left: 0.36rem;
  margin-right: 0.25rem;
  transform: translateY(-1px);
}

.header-mode-arc-item {
  width: 0.92rem;
  height: 0.92rem;
  border: 0;
  border-radius: 999px;
  background: transparent;
  color: rgba(255, 234, 195, 0.56) !important;
  font-size: 0.58rem;
  font-weight: 800;
  line-height: 1;
  text-transform: lowercase;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  text-shadow: 0 1px 0 rgba(0, 0, 0, 0.7);
  transition:
    color 120ms ease,
    transform 120ms ease,
    text-shadow 120ms ease,
    box-shadow 120ms ease;
}

.header-mode-arc-item.arc-1 {
  transform: translateY(2px);
}

.header-mode-arc-item.arc-2 {
  transform: translateY(0);
}

.header-mode-arc-item.arc-3 {
  transform: translateY(-2px);
}

.header-mode-arc-item:hover {
  color: rgba(255, 239, 210, 0.9) !important;
}

.header-mode-arc-item.is-active {
  color: #fff2ce !important;
  text-shadow:
    0 1px 0 rgba(0, 0, 0, 0.84),
    0 0 10px rgba(255, 194, 89, 0.72),
    0 0 18px rgba(245, 158, 11, 0.46);
  box-shadow:
    0 0 0 1px rgba(255, 188, 75, 0.28),
    0 0 10px rgba(255, 190, 80, 0.36);
}

.header-spacer {
  flex: 1;
}

.header-connection-array {
  position: relative;
  display: flex;
  align-items: center;
  gap: 0.35rem;
}

.header-connection-array::after {
  content: "";
  position: absolute;
  left: 0.3rem;
  right: 0.25rem;
  bottom: -0.36rem;
  height: 0.46rem;
  border-radius: 999px;
  pointer-events: none;
  background: radial-gradient(
    100% 120% at 50% 50%,
    rgba(0, 0, 0, 0.38) 0%,
    rgba(0, 0, 0, 0.2) 44%,
    rgba(0, 0, 0, 0) 100%
  );
  filter: blur(4px);
  opacity: 0.78;
}

.header-midi-signal {
  margin-left: 0.45rem;
  max-width: 220px;
  font-size: 0.6rem;
  color: rgba(0, 0, 0, 0.82);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  border-left: 1px solid rgba(0, 0, 0, 0.24);
  padding-left: 0.45rem;
}

.header-connection-chip {
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: 0.3rem;
  padding: 0.2rem 0.45rem !important;
  border-radius: 999px !important;
  border: 1px solid rgba(0, 0, 0, 0.3) !important;
  background: rgba(255, 255, 255, 0.2) !important;
  color: rgba(0, 0, 0, 0.9) !important;
  font-size: 0.62rem !important;
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.2),
    inset 0 -1px 0 rgba(0, 0, 0, 0.22),
    0 2px 4px rgba(0, 0, 0, 0.3) !important;
}

.header-connection-dot {
  width: 0.45rem;
  height: 0.45rem;
  border-radius: 999px;
  border: 1px solid rgba(0, 0, 0, 0.45);
}

.header-connection-dot.is-online {
  background: #16a34a;
}

.header-connection-dot.is-offline {
  background: #7c2d12;
}

.header-connection-dot.is-pulsing {
  animation: midiPulse 260ms ease-out;
  box-shadow: 0 0 0 3px rgba(45, 212, 191, 0.35);
}

@keyframes midiPulse {
  0% {
    transform: scale(1);
    opacity: 1;
  }
  60% {
    transform: scale(1.45);
    opacity: 0.85;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.header-connection-label {
  font-size: 0.6rem;
  font-weight: 700;
  letter-spacing: 0.04em;
}

.routing-modal-content {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.routing-modal-caption {
  font-size: 0.75rem;
  color: var(--color-muted-foreground);
  margin-bottom: 0.2rem;
}

.routing-group {
  display: flex;
  flex-direction: column;
  gap: 0.35rem;
  border-top: 1px solid rgba(255, 255, 255, 0.12);
  padding-top: 0.35rem;
}

.routing-group-title {
  font-size: 0.72rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.routing-row {
  display: flex;
  gap: 0.45rem;
  align-items: flex-start;
  padding: 0.25rem 0.3rem;
  border: 1px solid rgba(255, 255, 255, 0.08);
  border-radius: 6px;
}

.routing-row input[type="radio"] {
  margin-top: 0.15rem;
}

.routing-row-main {
  display: flex;
  flex-direction: column;
  gap: 0.12rem;
}

.routing-row-title {
  font-size: 0.78rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 0.3rem;
}

.routing-row-desc {
  font-size: 0.7rem;
  color: var(--color-muted-foreground);
}

.routing-pill {
  font-size: 0.62rem;
  text-transform: uppercase;
  border: 1px solid rgba(255, 255, 255, 0.25);
  border-radius: 999px;
  padding: 0.05rem 0.3rem;
}

.routing-inline-controls {
  display: grid;
  grid-template-columns: 1fr minmax(180px, 280px);
  gap: 0.45rem;
  margin: 0.1rem 0 0.25rem;
}

.routing-inline-label {
  display: flex;
  flex-direction: column;
  gap: 0.22rem;
  font-size: 0.68rem;
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.routing-inline-select {
  height: 1.7rem;
  font-size: 0.72rem;
  padding: 0 0.35rem !important;
}

.routing-channel-rail {
  width: 100%;
}

.routing-channel-picker {
  width: 132px;
  max-width: 100%;
}

.floating-option-picker {
  position: relative;
  width: 100%;
}

.floating-option-trigger {
  width: 100%;
  min-height: 1.9rem;
  border-radius: 0.6rem;
  border: none !important;
  color: rgba(255, 255, 255, 0.98) !important;
  padding: 0.28rem 0.5rem;
  display: inline-flex;
  align-items: center;
  justify-content: space-between;
  font-size: 0.72rem;
  letter-spacing: 0.03em;
  background:
    linear-gradient(
      180deg,
      rgba(255, 255, 255, 0.14) 0%,
      rgba(255, 255, 255, 0.05) 56%,
      rgba(255, 255, 255, 0.02) 100%
    ) !important;
  background-color: transparent !important;
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.18),
    inset 0 -1px 0 rgba(0, 0, 0, 0.24),
    0 3px 10px rgba(0, 0, 0, 0.28);
  text-shadow: 0 1px 0 rgba(0, 0, 0, 0.48);
}

.floating-option-trigger:hover {
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.24),
    inset 0 -1px 0 rgba(0, 0, 0, 0.3),
    0 4px 12px rgba(0, 0, 0, 0.36),
    0 0 8px rgba(255, 255, 255, 0.2);
}

.floating-option-trigger.is-open {
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.26),
    inset 0 -1px 0 rgba(0, 0, 0, 0.34),
    0 5px 12px rgba(0, 0, 0, 0.38),
    0 0 10px rgba(255, 255, 255, 0.2);
}

.floating-option-trigger.is-disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.floating-option-trigger-label {
  flex: 1;
  text-align: right;
  font-weight: 700;
  padding-right: 0.35rem;
  font-variant-numeric: tabular-nums;
}

.floating-option-trigger-caret {
  font-size: 0.7rem;
  opacity: 0.9;
}

.floating-option-panel {
  position: fixed;
  transform: translateY(-50%);
  width: 132px;
  border-radius: 0.7rem;
  border: 1px solid rgba(255, 255, 255, 0.16);
  background: rgba(255, 255, 255, 0.02);
  backdrop-filter: blur(9px);
  -webkit-backdrop-filter: blur(9px);
  box-shadow:
    0 16px 34px rgba(0, 0, 0, 0.42),
    0 0 0 1px rgba(255, 255, 255, 0.06) inset,
    0 0 18px rgba(255, 255, 255, 0.08);
  padding: 0.3rem;
  overflow-y: auto;
  z-index: 2200;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.floating-option-panel::-webkit-scrollbar {
  width: 0;
  height: 0;
}

.floating-option-item {
  width: 100%;
  border: 0;
  border-radius: 0.48rem;
  text-align: right;
  padding: 0.34rem 0.45rem;
  font-size: 0.72rem;
  color: rgba(255, 255, 255, 0.95) !important;
  background: transparent !important;
  background-color: transparent !important;
  text-shadow: 0 1px 0 rgba(0, 0, 0, 0.55);
  font-variant-numeric: tabular-nums;
}

.floating-option-item:hover {
  background: rgba(255, 255, 255, 0.14) !important;
  background-color: rgba(255, 255, 255, 0.14) !important;
}

.floating-option-item.is-selected {
  color: #ffffff !important;
  background:
    linear-gradient(
      180deg,
      rgba(255, 255, 255, 0.26) 0%,
      rgba(255, 255, 255, 0.16) 100%
    ) !important;
  background-color: rgba(255, 255, 255, 0.18) !important;
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.2),
    0 2px 10px rgba(0, 0, 0, 0.25);
}

.floating-slider-picker {
  position: relative;
  width: 100%;
}

.floating-slider-input {
  width: 100%;
  height: 0.5rem;
}

.floating-slider-input.is-disabled {
  opacity: 0.45;
  cursor: not-allowed;
}

.harmony-controls-panel {
  height: calc(25% + 7px) !important;
  position: relative;
  top: 0;
  overflow: hidden;
  padding: 0.5rem 0.75rem !important;
}

.harmony-controls-panel > .mb-2 {
  margin-bottom: 0.25rem;
}

.harmony-controls-grid {
  gap: 0.4rem 0.55rem !important;
}

.harmony-controls-grid label {
  margin-bottom: 0.15rem !important;
}

.harmony-controls-grid .text-\[10px\].muted-text.text-center {
  margin-top: 0.15rem !important;
}

.harmony-controls-actions {
  margin-top: 0.2rem !important;
  width: 7.25rem !important;
  gap: 0.3rem !important;
}

.floating-slider-panel {
  position: fixed;
  transform: translateY(-50%);
  width: 74px;
  max-height: 190px;
  overflow-y: auto;
  scroll-behavior: smooth;
  z-index: 2200;
  border-radius: 0.6rem;
  border: 1px solid rgba(255, 255, 255, 0.16);
  background: rgba(255, 255, 255, 0.02);
  backdrop-filter: blur(9px);
  -webkit-backdrop-filter: blur(9px);
  box-shadow:
    0 10px 24px rgba(0, 0, 0, 0.36),
    0 0 0 1px rgba(255, 255, 255, 0.05) inset;
  padding: 0.2rem;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.floating-slider-panel::-webkit-scrollbar {
  width: 0;
  height: 0;
}

.floating-slider-item {
  width: 100%;
  border: 0;
  border-radius: 0.35rem;
  background: transparent !important;
  background-color: transparent !important;
  color: rgba(255, 255, 255, 0.92) !important;
  text-align: right;
  font-size: 0.68rem;
  font-variant-numeric: tabular-nums;
  padding: 0.18rem 0.32rem;
  line-height: 1.2;
  text-shadow: 0 1px 0 rgba(0, 0, 0, 0.5);
}

.floating-slider-item:hover {
  background: rgba(255, 255, 255, 0.1) !important;
  background-color: rgba(255, 255, 255, 0.1) !important;
}

.floating-slider-item.is-selected {
  color: #ffffff !important;
  background: rgba(255, 255, 255, 0.2) !important;
  background-color: rgba(255, 255, 255, 0.2) !important;
}

.universal-select-rail {
  width: 100%;
}

.universal-select-rail-track {
  position: relative;
  display: grid;
  align-items: stretch;
  min-height: 2rem;
  border-radius: 999px;
  overflow: hidden;
  border: 1px solid rgba(255, 230, 184, 0.26);
  background:
    linear-gradient(
      180deg,
      rgba(255, 255, 255, 0.16) 0%,
      rgba(255, 255, 255, 0.07) 23%,
      rgba(0, 0, 0, 0.21) 58%,
      rgba(0, 0, 0, 0.4) 100%
    );
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.16),
    inset 0 -2px 0 rgba(0, 0, 0, 0.32),
    0 2px 6px rgba(0, 0, 0, 0.36);
  touch-action: none;
}

.universal-select-rail-active {
  position: absolute;
  top: 2px;
  bottom: 2px;
  left: 2px;
  border-radius: 999px;
  background:
    linear-gradient(
      180deg,
      rgba(255, 235, 197, 0.34) 0%,
      rgba(255, 220, 171, 0.2) 20%,
      rgba(245, 158, 11, 0.33) 70%,
      rgba(124, 45, 18, 0.32) 100%
    );
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.32),
    inset 0 -1px 0 rgba(0, 0, 0, 0.28),
    0 1px 8px rgba(245, 158, 11, 0.28);
  transition: transform 120ms ease-out, width 120ms ease-out;
  pointer-events: none;
}

.universal-select-rail-segment {
  position: relative;
  z-index: 1;
  min-width: 0;
  border: 0;
  background: transparent;
  color: rgba(242, 242, 242, 0.92);
  font-size: 0.66rem;
  font-weight: 700;
  letter-spacing: 0.04em;
  padding: 0 0.2rem;
}

.universal-select-rail-segment + .universal-select-rail-segment {
  box-shadow: -1px 0 0 rgba(255, 255, 255, 0.08) inset;
}

.universal-select-rail-segment.is-active {
  color: #fff7e0;
  text-shadow:
    0 1px 0 rgba(0, 0, 0, 0.72),
    0 0 8px rgba(255, 198, 95, 0.25);
}

.universal-select-rail-label {
  white-space: nowrap;
}

/* Modal/backdrop helpers */
.modal-backdrop {
  background-color: rgba(0, 0, 0, 0.7);
}
.btn-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: 6px;
  padding: 0.25rem;
  transition: background-color 0.12s ease;
}
.btn-icon:hover {
  background-color: color-mix(in srgb, var(--color-border) 8%, transparent);
}

/* Range slider (encoder) styling - Turquoise theme */
input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  background: transparent;
  cursor: pointer;
}

/* Track styling - show turquoise progress with brown unfilled */
input[type="range"]::-webkit-slider-track {
  background: linear-gradient(
    to right,
    #2dd4bf 0%,
    #2dd4bf var(--progress-percent, 50%),
    #654321 var(--progress-percent, 50%),
    #654321 100%
  );
  height: 4px;
  border-radius: 2px;
  border: 1px solid #654321; /* Brown border */
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4); /* Black shadow */
}

input[type="range"]::-moz-range-track {
  background: linear-gradient(
    to right,
    #2dd4bf 0%,
    #2dd4bf var(--progress-percent, 50%),
    #654321 var(--progress-percent, 50%),
    #654321 100%
  );
  height: 4px;
  border-radius: 2px;
  border: 1px solid #654321; /* Brown border */
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4); /* Black shadow */
}

/* Thumb styling - turquoise with brown border */
input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  height: 16px;
  width: 16px;
  border-radius: 50%;
  background: #2dd4bf; /* Turquoise thumb */
  border: 2px solid #654321; /* Brown border */
  cursor: pointer;
  box-shadow: 0 0 4px rgba(45, 212, 191, 0.6); /* Turquoise glow */
  position: relative;
  z-index: 1;
}

input[type="range"]::-moz-range-thumb {
  height: 16px;
  width: 16px;
  border-radius: 50%;
  background: #2dd4bf; /* Turquoise thumb */
  border: 2px solid #654321; /* Brown border */
  cursor: pointer;
  box-shadow: 0 0 4px rgba(45, 212, 191, 0.6); /* Turquoise glow */
}

/* Focus styling */
input[type="range"]:focus {
  outline: none;
}

input[type="range"]:focus::-webkit-slider-thumb {
  box-shadow:
    0 0 0 4px rgba(45, 212, 191, 0.4),
    0 0 8px rgba(255, 140, 0, 0.3); /* Turquoise and saffron glow */
}

input[type="range"]:focus::-moz-range-thumb {
  box-shadow:
    0 0 0 4px rgba(45, 212, 191, 0.4),
    0 0 8px rgba(255, 140, 0, 0.3); /* Turquoise and saffron glow */
}

/* ============================================================================
   Progression Editor Sliders
   ============================================================================ */

/* Progression zoom slider - matches timeline style */
.progression-zoom-slider {
  height: 3px;
  width: 100px;
  -webkit-appearance: none;
  appearance: none;
  background: rgba(0, 0, 0, 0.15);
  border-radius: 2px;
  outline: none;
  cursor: pointer;
  margin: 0 2px;
}

.progression-zoom-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 10px;
  height: 10px;
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid rgba(0, 0, 0, 0.4);
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
  transition: all 0.15s ease;
}

.progression-zoom-slider::-webkit-slider-thumb:hover {
  background: rgba(0, 0, 0, 0.4);
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.3);
}

.progression-zoom-slider::-moz-range-thumb {
  width: 10px;
  height: 10px;
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid rgba(0, 0, 0, 0.4);
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

/* Parameter sliders (repeats, beats per bar) */
.progression-param-slider {
  height: 3px;
  width: 80px;
  -webkit-appearance: none;
  appearance: none;
  background: rgba(0, 0, 0, 0.15);
  border-radius: 2px;
  outline: none;
  cursor: pointer;
}

.progression-param-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 12px;
  height: 12px;
  background: rgba(0, 0, 0, 0.35);
  border: 1px solid rgba(0, 0, 0, 0.5);
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);
  transition: all 0.15s ease;
}

.progression-param-slider::-webkit-slider-thumb:hover {
  background: rgba(0, 0, 0, 0.45);
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.35);
}

.progression-param-slider::-moz-range-thumb {
  width: 12px;
  height: 12px;
  background: rgba(0, 0, 0, 0.35);
  border: 1px solid rgba(0, 0, 0, 0.5);
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);
}

/* Duration pad states */
.duration-pad-off {
  background-color: rgba(255, 255, 255, 0.78) !important;
  background: rgba(255, 255, 255, 0.78) !important;
  color: rgba(10, 10, 10, 0.9) !important;
  border-color: rgba(255, 255, 255, 0.95) !important;
}

.duration-pad-on {
  background-color: #ffffff !important;
  background: #ffffff !important;
  color: #000000 !important;
  border-color: #ffffff !important;
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.3) !important;
}

/* Harmony matrix pad treatment: raised surface + selected glow */
.matrix-pad {
  position: relative;
  isolation: isolate;
  filter: none !important;
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.18),
    inset 0 -2px 0 rgba(0, 0, 0, 0.3),
    0 4px 8px rgba(0, 0, 0, 0.42) !important;
}

.matrix-pad::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events: none;
  background: linear-gradient(
    180deg,
    rgba(255, 255, 255, 0.14) 0%,
    rgba(255, 255, 255, 0.03) 34%,
    rgba(0, 0, 0, 0.12) 100%
  );
  z-index: 0;
}

.matrix-pad > * {
  position: relative;
  z-index: 1;
}

.matrix-pad-selected {
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.24),
    inset 0 -2px 0 rgba(0, 0, 0, 0.34),
    0 0 0 1px rgba(45, 212, 191, 0.72),
    0 0 14px rgba(45, 212, 191, 0.58),
    0 0 26px rgba(45, 212, 191, 0.34),
    0 6px 12px rgba(0, 0, 0, 0.45) !important;
}

.matrix-pad-filled {
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.18),
    inset 0 -2px 0 rgba(0, 0, 0, 0.3),
    0 0 10px rgba(255, 170, 66, 0.22),
    0 4px 8px rgba(0, 0, 0, 0.42) !important;
}

/* Sequencer row: slightly raised, active steps glow */
.sequencer-step-pad {
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.1),
    inset 0 -1px 0 rgba(0, 0, 0, 0.24),
    0 3px 7px rgba(0, 0, 0, 0.35) !important;
}

.sequencer-step-pad.duration-pad-off {
  background: #000000 !important;
  background-color: #000000 !important;
  background-image: none !important;
  color: rgba(160, 160, 160, 0.85) !important;
  border-color: rgba(255, 255, 255, 0.24) !important;
  box-shadow:
    none !important;
}

.sequencer-step-pad.duration-pad-on {
  background: #ffffff !important;
  background-color: #ffffff !important;
  background-image: none !important;
  color: #000000 !important;
  border-color: #ffffff !important;
  box-shadow:
    inset 0 0 18px rgba(255, 255, 255, 0.9),
    inset 0 0 34px rgba(255, 255, 255, 0.55),
    inset 0 1px 0 rgba(255, 255, 255, 0.35),
    0 0 0 1px rgba(255, 255, 255, 0.72),
    0 0 14px rgba(255, 255, 255, 0.7),
    0 0 28px rgba(255, 255, 255, 0.4),
    0 4px 9px rgba(0, 0, 0, 0.35) !important;
}

/* Sequencer look/feel refinement */
.sequencer-lane {
  position: relative;
  padding: 0.35rem 0.1rem 0.15rem;
  border-radius: 8px;
  background:
    linear-gradient(
      180deg,
      rgba(255, 255, 255, 0.06) 0%,
      rgba(255, 255, 255, 0.01) 20%,
      rgba(0, 0, 0, 0.18) 100%
    );
}

.sequencer-lane::before {
  content: "";
  position: absolute;
  left: 0.2rem;
  right: 0.2rem;
  top: 0.15rem;
  height: 1px;
  background: rgba(255, 184, 88, 0.35);
  pointer-events: none;
}

.sequencer-lane-header {
  margin-bottom: 0.3rem !important;
}

.sequencer-cell {
  border-radius: 4px !important;
  border: 1px solid rgba(255, 180, 78, 0.34) !important;
  background-clip: padding-box;
  transform: translateZ(0);
}

.sequencer-cell-off {
  background:
    linear-gradient(
      180deg,
      rgba(255, 255, 255, 0.04) 0%,
      rgba(0, 0, 0, 0.18) 36%,
      rgba(0, 0, 0, 0.28) 100%
    ) !important;
  color: rgba(188, 188, 188, 0.72) !important;
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.08),
    inset 0 -2px 0 rgba(0, 0, 0, 0.35),
    0 2px 5px rgba(0, 0, 0, 0.46) !important;
}

.sequencer-cell-on {
  box-shadow:
    inset 0 1px 0 rgba(255, 245, 224, 0.4),
    inset 0 -2px 0 rgba(0, 0, 0, 0.24),
    0 0 0 1px rgba(255, 184, 74, 0.58),
    0 0 13px rgba(255, 174, 61, 0.34),
    0 4px 9px rgba(0, 0, 0, 0.48) !important;
}

.matrix-pad-index {
  font-size: 0.62rem;
  color: rgba(16, 16, 16, 0.75);
  letter-spacing: 0.02em;
}

.matrix-pad-label {
  color: rgba(0, 0, 0, 0.96);
  text-shadow: 0 1px 0 rgba(255, 255, 255, 0.24);
}

.sequencer-step-index {
  font-size: 0.65rem;
  font-weight: 700;
  letter-spacing: 0.02em;
}

.duration-pad-off {
  background: rgba(255, 255, 255, 0.78) !important;
  color: rgba(10, 10, 10, 0.9) !important;
  border-color: rgba(255, 255, 255, 0.95) !important;
  box-shadow:
    inset 0 0 10px rgba(255, 255, 255, 0.35),
    inset 0 1px 0 rgba(255, 255, 255, 0.85),
    0 0 8px rgba(255, 255, 255, 0.35),
    0 3px 8px rgba(0, 0, 0, 0.35) !important;
}

.duration-pad-on {
  background: #ffffff !important;
  color: #000000 !important;
  border-color: #ffffff !important;
  box-shadow:
    inset 0 0 18px rgba(255, 255, 255, 0.9),
    inset 0 0 34px rgba(255, 255, 255, 0.55),
    inset 0 1px 0 rgba(255, 255, 255, 0.95),
    0 0 0 1px rgba(255, 255, 255, 0.92),
    0 0 14px rgba(255, 255, 255, 0.75),
    0 0 26px rgba(255, 255, 255, 0.42),
    0 5px 10px rgba(0, 0, 0, 0.46) !important;
}

/* Text accent colors for non-chord elements */
.text-orange {
  color: #ff8c00 !important;
}

.text-turquoise {
  color: #2dd4bf !important;
}

.text-yellow {
  color: #fbbf24 !important;
}

/* Progression editor  force compact black text for yellow/action buttons
   Use a highly-specific selector and include dark-mode variant to override
   other broad rules that make button text large/white. */
.progression-editor .btn-yellow,
.dark .progression-editor .btn-yellow,
.progression-editor .btn-small,
.dark .progression-editor .btn-small,
.progression-editor button.btn-icon,
.dark .progression-editor button.btn-icon,
/* Target the actual component root used in the JSX */
.progression-editor-content .btn-yellow,
.dark .progression-editor-content .btn-yellow,
.progression-editor-content .btn-small,
.dark .progression-editor-content .btn-small,
.progression-editor-content button.btn-icon,
.dark .progression-editor-content button.btn-icon,
.progression-editor-content button,
.dark .progression-editor-content button,
html.dark .progression-editor-content button {
  color: #000000 !important;
  font-size: 0.625rem !important; /* 10px */
  padding: 0.15rem 0.4rem !important;
  line-height: 1 !important;
  text-transform: none !important;
}

.progression-editor-content .btn-small,
.dark .progression-editor-content .btn-small,
html.dark .progression-editor-content .btn-small {
  font-size: 0.5rem !important; /* 8px */
  padding: 0.125rem 0.3rem !important;
}

/* Make svg icons inside those buttons small and inherit the text color */
.progression-editor-content .btn-yellow svg,
.dark .progression-editor-content .btn-yellow svg,
.progression-editor-content button.btn-icon svg,
.dark .progression-editor-content button.btn-icon svg,
html.dark .progression-editor-content button svg {
  width: 12px !important;
  height: 12px !important;
  stroke: currentColor !important;
  fill: none !important;
}

/* If the button has a label span, ensure it inherits and is tiny */
.progression-editor-content .btn-yellow .btn-label,
.dark .progression-editor-content .btn-yellow .btn-label,
.progression-editor-content .btn-small .btn-label,
.dark .progression-editor-content .btn-small .btn-label,
html.dark .progression-editor-content .btn-label {
  font-size: 0.5rem !important; /* 8px */
  color: inherit !important;
  margin-left: 0.25rem;
}

/* Beat pad context menu animation */
.beat-pad-context-menu {
  animation: fadeInScale 0.15s ease-out;
}

@keyframes fadeInScale {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* Flip card container for contextual navigation drawer */
.flip-container {
  perspective: 1200px;
  width: 100%;
  height: 100%;
}
.flip-inner {
  position: relative;
  width: 100%;
  height: 100%;
  -webkit-transform-style: preserve-3d !important;
  transform-style: preserve-3d !important;
  -webkit-transition: -webkit-transform 0.6s cubic-bezier(0.23, 1, 0.32, 1) !important;
  transition: transform 0.6s cubic-bezier(0.23, 1, 0.32, 1) !important;
  transform-origin: center center;
  will-change: transform;
}
.flip-container.is-flipped .flip-inner {
  -webkit-transform: rotateY(180deg) !important;
  transform: rotateY(180deg) !important;
}

/* Compact left menu: reduce padding/gaps to avoid scrollbars */
.menu-compact {
  font-size: 12px;
}
.menu-compact .muted-text {
  font-size: 11px;
}
.menu-compact .grid {
  gap: 0.25rem !important;
}
.menu-compact .grid.grid-cols-2 > button,
.menu-compact button.btn-muted {
  padding: 0.28rem 0.45rem !important;
  font-size: 0.75rem !important;
  min-width: 0 !important;
}
.menu-compact .flex.gap-1 > button,
.menu-compact .flex.gap-1 > .px-2 {
  padding: 0.18rem 0.35rem !important;
  font-size: 0.72rem !important;
}
.menu-compact .quick-sections {
  display: flex;
  gap: 0.25rem;
  padding-top: 0.25rem;
}
.menu-compact .quick-sections button {
  padding: 0.18rem 0.3rem !important;
  font-size: 0.72rem !important;
  min-width: 2.2rem !important;
}
.menu-compact .card,
.menu-compact .panel {
  padding: 0.25rem !important;
}
.menu-compact .btn-muted {
  border-radius: 6px !important;
}

/* Extra-compact styling for the flip-back contextual panel (make settings much smaller) */
.flip-back,
.flip-back * {
  font-size: 0.62rem !important; /* make much smaller so lines fit */
}
.flip-back .text-sm {
  font-size: 0.66rem !important;
}
.flip-back .muted-text {
  font-size: 0.64rem !important;
}
.flip-back .space-y-2 > * {
  margin-top: 0 !important;
  margin-bottom: 0 !important;
}
.flip-back input,
.flip-back select,
.flip-back textarea {
  padding: 0.12rem 0.2rem !important;
  font-size: 0.62rem !important;
  border-radius: 6px !important;
}
.flip-back button,
.flip-back .btn-muted,
.flip-back .btn-small {
  padding: 0.12rem 0.26rem !important;
  font-size: 0.62rem !important;
  line-height: 1 !important;
}
.flip-back .card,
.flip-back .panel {
  padding: 0 !important;
  margin: 0 !important;
}
.flip-back .quick-sections {
  gap: 0.25rem !important;
}
.flip-back .tools-panel * {
  font-size: 0.62rem !important;
}

/* Force compact grids inside flip-back */
.flip-back .grid {
  gap: 0.25rem !important;
}

/* Ensure long text fits: cap widths, allow wrapping, and truncate where necessary */
.flip-back {
  box-sizing: border-box;
  max-width: 100%;
  overflow-wrap: anywhere;
}

/* Override Tailwind `p-2` used inside the flip-back markup so content sits flush */
.flip-back .p-2 {
  padding: 0 !important;
}
.flip-back label,
.flip-back .text-sm,
.flip-back .muted-text,
.flip-back .card-title,
.flip-back .panel-title,
.flip-back button {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.flip-front,
.flip-back {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}
.flip-front {
  transform: rotateY(0deg);
}
.flip-back {
  transform: rotateY(180deg);
  background: rgba(0,0,0,0.06);
  backdrop-filter: blur(4px);
  padding: 0 !important;
  box-sizing: border-box;
  overflow: auto; /* allow scrolling when content exceeds panel height */
  -webkit-overflow-scrolling: touch;
}

.flip-back:focus {
  outline: none;
}

/* Subtle shadow to give the flip card visual depth */
.flip-front,
.flip-back {
  border-radius: 6px;
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.22);
}

/* Slightly stronger shadow while flipped to accentuate the back face */
.flip-container.is-flipped .flip-inner {
  box-shadow: 0 14px 30px rgba(0, 0, 0, 0.28);
}

/* Menu visual effects removed (reverted per user request) */

/* Global button border reset */
button,
.btn,
.btn-small,
.btn-yellow,
.btn-primary,
.btn-muted,
.btn-icon {
  border: none !important;
}

